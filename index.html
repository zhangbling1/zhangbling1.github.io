<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antigravity Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Playfair+Display:ital,wght@1,600&display=swap" rel="stylesheet">

    <style>
        /* ================== 1. åŸºç¡€é‡ç½® ================== */
        body { margin: 0; background-color: #f0f2f5; font-family: 'Inter', sans-serif; color: #1f1f1f; overflow-x: hidden; }
        canvas { display: block; position: fixed; top: 0; left: 0; z-index: -1; }

        /* ================== 2. UI æ¡†æ¶ ================== */
        .content-layer {
            position: relative; z-index: 10; width: 100%; min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
            /* âš ï¸ å¼ºåˆ¶æ˜¾ç¤ºï¼Œé˜²æ­¢ç™½å± */
            opacity: 1; 
        }

        /* å¯¼èˆª */
        nav {
            position: fixed; top: 0; left: 0; right: 0; padding: 20px 40px;
            display: flex; justify-content: space-between; align-items: center;
            background: linear-gradient(to bottom, rgba(255,255,255,0.95), rgba(255,255,255,0));
            z-index: 100;
        }
        .brand-container { display: flex; align-items: center; gap: 12px; text-decoration: none; }
        .nav-icon { height: 32px; width: auto; }
        .logo-text { font-family: 'Inter', sans-serif; font-weight: 800; font-size: 1.4rem; color: #1a1a1a; letter-spacing: -0.5px; text-transform: uppercase; }

        /* Hero */
        .hero-section { margin-top: 15vh; margin-bottom: 40px; text-align: center; }
        .title-wrapper h1 { font-size: 5.5rem; line-height: 1.0; margin: 0 0 10px 0; color: #1a1a1a; letter-spacing: -2px; }
        .word-digital { font-family: 'Inter', sans-serif; font-weight: 800; }
        .word-biology { font-family: 'Playfair Display', serif; font-style: italic; font-weight: 600; }
        .hero-section p { font-size: 0.9rem; color: #666; letter-spacing: 1px; margin-top: 20px; }

        /* ç­›é€‰æ  */
        .filter-wrapper {
            display: flex; gap: 8px; justify-content: center;
            background: rgba(255,255,255,0.5); backdrop-filter: blur(10px);
            padding: 6px; border-radius: 50px; margin-top: 40px;
            border: 1px solid rgba(255,255,255,0.6);
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }
        .filter-btn {
            border: none; background: transparent; padding: 10px 24px; border-radius: 40px;
            cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; align-items: center;
        }
        .filter-btn .zh { font-size: 0.9rem; font-weight: 700; color: #555; }
        .filter-btn .en { font-size: 0.6rem; font-weight: 600; color: #999; margin-top: 2px; text-transform: uppercase; }
        .filter-btn:hover { background: rgba(255,255,255,0.8); }
        .filter-btn.active { background: #1a1a1a; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .filter-btn.active .zh { color: #fff; }
        .filter-btn.active .en { color: rgba(255,255,255,0.7); }

        @media (max-width: 600px) {
            .hero-section { padding: 0 20px; margin-top: 12vh; }
            .title-wrapper h1 { font-size: 3rem; }
            .filter-wrapper { display: grid; grid-template-columns: repeat(3, 1fr); border-radius: 20px; padding: 10px; width: 90%; }
            .filter-btn { padding: 8px 0; background: rgba(255,255,255,0.5); width: 100%; }
            .nav-icon { height: 24px; } nav { padding: 15px 20px; }
        }

        /* ================== 4. ç€‘å¸ƒæµå®¹å™¨ ================== */
        .galleries-wrapper { width: 100%; max-width: 1600px; padding: 0 40px 100px; box-sizing: border-box; }
        .gallery-container { display: flex; align-items: flex-start; justify-content: center; gap: 30px; width: 100%; }
        .masonry-column { flex: 1; display: flex; flex-direction: column; gap: 30px; min-width: 0; }

        /* å¡ç‰‡è®¾è®¡ - ä¼˜åŒ–åŠ¨æ•ˆ */
        .photo-card {
            width: 100%; border-radius: 16px; overflow: hidden;
            background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.6);
            box-shadow: 0 4px 15px rgba(0,0,0,0.03); 
            /* åªå¯¹ transform å’Œ shadow åšè¿‡æ¸¡ï¼Œé˜²æ­¢å¡é¡¿ */
            transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1), box-shadow 0.4s ease;
            cursor: pointer; display: flex; flex-direction: column; position: relative;
            /* åˆå§‹é€æ˜ */
            opacity: 0; transform: translateY(30px);
        }

        /* å¡ç‰‡æ‚¬åœï¼šè½»å¾®ä¸Šæµ®ï¼Œä¸ç¼©æ”¾ */
        .photo-card:hover { 
            transform: translateY(-6px); 
            box-shadow: 0 20px 40px rgba(66, 133, 244, 0.15); 
            background: #fff; z-index: 2; 
        }
        
        .media-wrapper { 
            position: relative; width: 100%; background: rgba(0,0,0,0.05); overflow: hidden; 
            min-height: 100px; /* æœ€å°é«˜åº¦å ä½ */
        }
        
        .photo-card img, .photo-card video { 
            width: 100%; height: 100%; display: block; object-fit: cover; 
            /* å›¾ç‰‡å†…éƒ¨æ”¾å¤§åŠ¨æ•ˆ */
            transition: transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); 
        }
        
        /* æ‚¬åœæ—¶ï¼šå›¾ç‰‡å†…éƒ¨ç¼“æ…¢æ”¾å¤§ */
        .photo-card:hover img, .photo-card:hover video { transform: scale(1.06); }

        .card-info { padding: 16px 20px; background: rgba(255,255,255,0.4); }
        .card-tag { font-size: 0.7rem; font-weight: 700; color: #4285F4; text-transform: uppercase; display: block; margin-bottom: 4px; }
        .card-title { font-size: 0.95rem; font-weight: 800; color: #222; margin: 0; letter-spacing: 0.5px; }
        .video-badge { position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.6); color: #fff; padding: 3px 6px; border-radius: 4px; font-size: 0.6rem; font-weight: 700; backdrop-filter: blur(4px); z-index: 5; }

        /* ç¯ç®± */
        #lightbox { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; backdrop-filter: blur(10px); }
        #lightbox.active { opacity: 1; pointer-events: auto; }
        #lightbox-content { max-width: 90%; max-height: 90%; display: flex; justify-content: center; align-items: center; }
        #lightbox img, #lightbox video { max-width: 100%; max-height: 90vh; border-radius: 4px; box-shadow: 0 0 50px rgba(0,0,0,0.5); transform: scale(0.95); transition: transform 0.3s; }
        #lightbox.active img, #lightbox.active video { transform: scale(1); }
        .close-btn { position: absolute; top: 30px; right: 40px; color: #fff; font-size: 2rem; cursor: pointer; }

        footer { padding: 40px; text-align: center; color: #888; font-size: 0.9rem; margin-top: auto; }
    </style>
</head>
<body>
    
    <canvas id="canvas"></canvas>

    <div id="lightbox" onclick="closeLightbox()"><div class="close-btn">&times;</div><div id="lightbox-content"></div></div>

    <nav>
        <a href="#" class="brand-container">
            <svg class="nav-icon" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 4L4 36H36L20 4Z" fill="url(#paint0_linear)"/>
                <circle cx="20" cy="24" r="6" fill="white"/>
                <defs><linearGradient id="paint0_linear" x1="20" y1="4" x2="20" y2="36" gradientUnits="userSpaceOnUse"><stop stop-color="#4285F4"/><stop offset="1" stop-color="#40E0D0"/></linearGradient></defs>
            </svg>
            <span class="logo-text">ART PORTFOLIO</span>
        </a>
    </nav>

    <div class="content-layer">
        <div class="hero-section">
            <div class="title-wrapper">
                <h1><span class="word-digital">Design</span><span class="word-biology">Portfolio.</span></h1>
                <p>Check out the latest online display of the portfolio</p>
            </div>
            <div class="filter-wrapper" id="filters"></div>
        </div>

        <div class="galleries-wrapper">
            <div class="gallery-container" id="gallery-container"></div>
        </div>
        
        <footer>Â© 2026 Created by Zhangbling & Gemini</footer>
    </div>

    <script>
        // =========================================================================
        // ğŸ”§ è‡ªå®šä¹‰æ ‡é¢˜é…ç½®
        // =========================================================================
        const CUSTOM_TITLES = {
            'CG Style/1.jpg': 'é»‘æš—ä¹‹é­‚åŒäºº',
            'CG Style/2.jpg': 'èµ›åšæœ‹å…‹è®¾å®š',
            // 'Cartoon/5.webp': 'å¿«ä¹å°é•‡è®¾å®š',  <-- å¯¹åº”ä½ çš„æ–‡ä»¶å
        };

        // ğŸŸ¢ åˆ†ç±»é…ç½® (é¡ºåºå†³å®šæ˜¾ç¤ºé¡ºåº)
        const CATEGORIES = [
            { id: 'CG Style',    name: 'CGé£æ ¼',    en: 'CG Style' }, 
            { id: 'Cartoon',     name: 'æ¬§ç¾å¡é€š',  en: 'Cartoon' },
            { id: 'Icon Design', name: 'iconè®¾è®¡',  en: 'Icon Design' },
            { id: 'Character',   name: 'è§’è‰²åŸç”»',  en: 'Character' },
            { id: 'Other',       name: 'å…¶ä»–ç±»å‹',  en: 'Other' },
        ];

        // æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ (åŒ…å«äº†ä½ æˆªå›¾é‡Œçš„ webp)
        const SUPPORTED_FORMATS = ['.webp', '.png', '.jpg', '.jpeg', '.gif', '.mp4', '.mov'];
        const MAX_SEARCH = 200; // æœ€å¤šæ‰¾å¤šå°‘å¼ ï¼Œè®¾å¤§ä¸€ç‚¹ä»¥é˜²ä¸‡ä¸€

        // ç²’å­å‚æ•° (ä¿æŒä¸åŠ¨)
        const CONFIG = {
            introDuration: 200, explosionForce: 40, drag: 0.7, returnStrength: 0.01,
            particleCount: 1500, clusterRadius: 450, clusterRatioX: 1.55, clusterRatioY: 1.0, minDistance: 24,
            voidBaseSize: 110, voidBreathing: 15, voidMoveSpeed: 0.002, voidWaitTime: 400,
            sizeMin: 1.0, sizeMax: 3.5, sizePeakPos: 0.85, aspectRatio: 1.6,
            colorBase: { r: 66, g: 133, b: 244 }, colorHover: { r: 64, g: 224, b: 208 }, 
            mouseRepelDist: 160, mouseSenseDist: 350, colorChangeDist: 180,
            noiseScale: 0.003, timeSpeed: 0.0002, minLife: 300, maxLife: 800, fadeSpeed: 0.02
        };

        // =========================================================================
        // ğŸš€ æ ¸å¿ƒé€»è¾‘
        // =========================================================================
        const filters = document.getElementById('filters');
        const galleryContainer = document.getElementById('gallery-container');
        const lightbox = document.getElementById('lightbox');
        const lightboxContent = document.getElementById('lightbox-content');
        
        let activeColumns = []; // å­˜å‚¨å½“å‰å±å¹•ä¸Šçš„åˆ— DOM
        let activeColumnHeights = []; // å­˜å‚¨å½“å‰åˆ—çš„è™šæ‹Ÿé«˜åº¦
        let pendingItems = {}; // å¾…å¤„ç†å›¾ç‰‡é˜Ÿåˆ— { 'CG Style': [item, item...] }

        function initPortfolio() {
            createFilterBtn('all', 'å…¨éƒ¨ä½œå“', 'ALL WORKS', true);
            CATEGORIES.forEach(cat => createFilterBtn(cat.id, cat.name, cat.en));
            loadCategory('all');
            
            // å¯åŠ¨å®šæ—¶å™¨ï¼Œæ¯ 150ms å¤„ç†ä¸€æ¬¡æ–°å›¾ç‰‡ (æ¶ˆç­é—ªçƒçš„æ ¸å¿ƒ)
            setInterval(processQueue, 150);
        }

        function createFilterBtn(id, zh, en, isActive=false) {
            const btn = document.createElement('div');
            btn.className = `filter-btn ${isActive ? 'active' : ''}`;
            btn.innerHTML = `<span class="zh">${zh}</span><span class="en">${en}</span>`;
            btn.onclick = () => switchFilter(id, btn);
            filters.appendChild(btn);
        }

        function switchFilter(id, btn) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            loadCategory(id);
        }

        function loadCategory(filterId) {
            // 1. æ¸…ç©ºå½“å‰å®¹å™¨
            galleryContainer.innerHTML = '';
            activeColumns = [];
            activeColumnHeights = [];
            pendingItems = {}; // æ¸…ç©ºå¾…å¤„ç†é˜Ÿåˆ—

            // 2. å“åº”å¼åˆ›å»ºåˆ—
            let colCount = 4;
            const w = window.innerWidth;
            if (w <= 600) colCount = 1;
            else if (w <= 1000) colCount = 2;
            else if (w <= 1400) colCount = 3;

            for (let i = 0; i < colCount; i++) {
                const col = document.createElement('div');
                col.className = 'masonry-column';
                galleryContainer.appendChild(col);
                activeColumns.push(col);
                activeColumnHeights.push(0);
            }

            // 3. å¯åŠ¨ä¾¦å¯Ÿå…µ
            const targetCats = (filterId === 'all') ? CATEGORIES : CATEGORIES.filter(c => c.id === filterId);
            
            targetCats.forEach((cat, catIndex) => {
                // catIndex ç”¨äºåœ¨â€œå…¨éƒ¨ä½œå“â€ä¸­æ’åº (0, 1, 2...)
                for (let i = 1; i <= 5; i++) {
                    startScout(cat.id, cat.name, cat.en, i, filterId, catIndex);
                }
            });
        }

        // é¢„åŠ è½½è·å–å°ºå¯¸ (é˜²æ­¢æ’ç‰ˆå¡Œé™·)
        function preloadImage(url) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve({ ratio: img.width / img.height });
                img.onerror = () => resolve(null);
                img.src = url;
            });
        }

        // è‡ªåŠ¨æ‰¾å›¾ (Auto-Pilot)
        async function startScout(folder, catName, catEn, index, catId, catOrder, errors = 0) {
            if (errors > 3 || index > MAX_SEARCH) return;

            const mediaInfo = await findMedia(folder, index);

            if (mediaInfo) {
                // æ‰¾åˆ°äº†ï¼å…ˆè·å–å°ºå¯¸
                let dimensions = { ratio: 1.6 }; // é»˜è®¤
                if (mediaInfo.type === 'image') {
                    const loadedDim = await preloadImage(mediaInfo.src);
                    if (loadedDim) dimensions = loadedDim;
                } else {
                    dimensions = { ratio: 1.77 }; // è§†é¢‘
                }

                // åŠ å…¥å¾…å¤„ç†é˜Ÿåˆ—
                if (!pendingItems[catId]) pendingItems[catId] = [];
                
                const fileKey = `${folder}/${index}${mediaInfo.ext}`;
                const customTitle = CUSTOM_TITLES[fileKey];

                pendingItems[catId].push({
                    index,
                    media: mediaInfo,
                    catName,
                    displayTitle: customTitle || catEn,
                    catOrder,
                    ratio: dimensions.ratio
                });

                // ç»§ç»­æ‰¾ä¸‹ä¸€å¼ 
                startScout(folder, catName, catEn, index + 5, catId, catOrder, 0);
            } else {
                // æ²¡æ‰¾åˆ°ï¼Œå°è¯•ä¸‹ä¸€ä¸ª
                startScout(folder, catName, catEn, index + 5, catId, catOrder, errors + 1);
            }
        }

        // é˜Ÿåˆ—å¤„ç† (æ’åº + æ¸²æŸ“)
        function processQueue() {
            // åˆå¹¶æ‰€æœ‰é˜Ÿåˆ—é‡Œçš„å›¾ (é’ˆå¯¹â€œå…¨éƒ¨ä½œå“â€è§†å›¾)
            let allPending = [];
            for (let key in pendingItems) {
                allPending = allPending.concat(pendingItems[key]);
            }
            if (allPending.length === 0) return;

            // ğŸŒŸ æ’åºï¼šä¼˜å…ˆæŒ‰åˆ†ç±»é¡ºåºï¼Œç„¶åæŒ‰æ–‡ä»¶å(å¤§å·åœ¨å‰)
            allPending.sort((a, b) => {
                if (a.catOrder !== b.catOrder) return a.catOrder - b.catOrder;
                return b.index - a.index; 
            });

            // æ¸²æŸ“å¹¶æ’å…¥åˆ°æœ€çŸ­åˆ—
            allPending.forEach(item => {
                // æ‰¾æœ€çŸ­åˆ—
                let minIndex = 0;
                for (let i = 1; i < activeColumnHeights.length; i++) {
                    if (activeColumnHeights[i] < activeColumnHeights[minIndex]) minIndex = i;
                }

                // åˆ›å»ºå¡ç‰‡
                const card = createCardDOM(item);
                activeColumns[minIndex].appendChild(card); // æ’åˆ°å±å¹•ä¸Š

                // æ›´æ–°é«˜åº¦
                activeColumnHeights[minIndex] += (1 / item.ratio);

                // è¿›åœºåŠ¨ç”»
                setTimeout(() => {
                    card.style.opacity = 1;
                    card.style.transform = 'translateY(0)';
                }, 50);
            });

            // æ¸…ç©ºé˜Ÿåˆ—
            pendingItems = {};
        }

        function createCardDOM(item) {
            const div = document.createElement('div');
            div.className = 'photo-card';
            
            let mediaHtml = '';
            if (item.media.type === 'video') {
                mediaHtml = `<video src="${item.media.src}" autoplay muted loop playsinline></video><div class="video-badge">VIDEO</div>`;
            } else {
                mediaHtml = `<img src="${item.media.src}" alt="${item.catName}" loading="lazy">`;
            }
            div.innerHTML = `
                <div class="media-wrapper" style="aspect-ratio: ${item.ratio}">
                    ${mediaHtml}
                </div>
                <div class="card-info">
                    <span class="card-tag">${item.catName}</span>
                    <h3 class="card-title">${item.displayTitle}</h3>
                </div>
            `;
            div.onclick = () => openLightbox(item.media);
            return div;
        }

        function findMedia(folder, index) {
            return new Promise(async resolve => {
                for (let ext of SUPPORTED_FORMATS) {
                    const src = `images/${folder}/${index}${ext}`;
                    try {
                        const res = await fetch(src, { method: 'HEAD' });
                        if (res.ok) {
                            const isVideo = ext === '.mp4' || ext === '.mov';
                            resolve({ src, type: isVideo ? 'video' : 'image', ext });
                            return;
                        }
                    } catch(e) {}
                }
                resolve(null);
            });
        }

        // ç¯ç®± & æ‚é¡¹
        function openLightbox(media) {
            let content = media.type === 'video' ? `<video src="${media.src}" autoplay loop controls playsinline></video>` : `<img src="${media.src}">`;
            lightboxContent.innerHTML = content;
            lightbox.classList.add('active');
        }
        function closeLightbox() {
            lightbox.classList.remove('active');
            setTimeout(() => lightboxContent.innerHTML = '', 300);
        }
        window.addEventListener('resize', () => {
            const activeBtn = document.querySelector('.filter-btn.active');
            if (activeBtn) setTimeout(() => activeBtn.click(), 500);
        });

        // ç²’å­åŠ¨ç”» (å®Œæ•´ç‰ˆ)
        const contentLayer = document.querySelector('.content-layer');
        let width, height, DPR;
        let particles = [];
        const mouse = { x: -5000, y: -5000 };
        const Simplex=(function(){const p=new Uint8Array([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]);const perm=new Uint8Array(512);for(let i=0;i<512;i++)perm[i]=p[i&255];const grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];return{noise3D:(x,y,z)=>{let n0,n1,n2,n3;const F3=1.0/3.0,s=(x+y+z)*F3,i=Math.floor(x+s),j=Math.floor(y+s),k=Math.floor(z+s);const G3=1.0/6.0,t=(i+j+k)*G3,X0=i-t,Y0=j-t,Z0=k-t,x0=x-X0,y0=y-Y0,z0=z-Z0;let i1,j1,k1,i2,j2,k2;if(x0>=y0){if(y0>=z0){i1=1;j1=0;k1=0;i2=1;j2=1;k2=0;}else if(x0>=z0){i1=1;j1=0;k1=0;i2=1;j2=0;k2=1;}else{i1=0;j1=0;k1=1;i2=1;j2=0;k2=1;}}else{if(y0<z0){i1=0;j1=0;k1=1;i2=0;j2=1;k2=1;}else if(x0<z0){i1=0;j1=1;k1=0;i2=0;j2=1;k2=1;}else{i1=0;j1=1;k1=0;i2=1;j2=1;k2=0;}}const x1=x0-i1+G3,y1=y0-j1+G3,z1=z0-k1+G3,x2=x0-i2+2.0*G3,y2=y0-j2+2.0*G3,z2=z0-k2+2.0*G3,x3=x0-1.0+3.0*G3,y3=y0-1.0+3.0*G3,z3=z0-1.0+3.0*G3;const ii=i&255,jj=j&255,kk=k&255;const gi0=perm[ii+perm[jj+perm[kk]]]%12,gi1=perm[ii+i1+perm[jj+j1+perm[kk+k1]]]%12,gi2=perm[ii+i2+perm[jj+j2+perm[kk+k2]]]%12,gi3=perm[ii+1+perm[jj+1+perm[kk+1]]]%12;let t0=0.6-x0*x0-y0*y0-z0*z0;if(t0<0)n0=0.0;else{t0*=t0;n0=t0*t0*(grad3[gi0][0]*x0+grad3[gi0][1]*y0+grad3[gi0][2]*z0);}let t1=0.6-x1*x1-y1*y1-z1*z1;if(t1<0)n1=0.0;else{t1*=t1;n1=t1*t1*(grad3[gi1][0]*x1+grad3[gi1][1]*y1+grad3[gi1][2]*z1);}let t2=0.6-x2*x2-y2*y2-z2*z2;if(t2<0)n2=0.0;else{t2*=t2;n2=t2*t2*(grad3[gi2][0]*x2+grad3[gi2][1]*y2+grad3[gi2][2]*z2);}let t3=0.6-x3*x3-y3*y3-z3*z3;if(t3<0)n3=0.0;else{t3*=t3;n3=t3*t3*(grad3[gi3][0]*x3+grad3[gi3][1]*y3+grad3[gi3][2]*z3);}return 32.0*(n0+n1+n2+n3);}}})();
        function init(){DPR=window.devicePixelRatio||1;width=window.innerWidth;height=window.innerHeight;canvas.width=width*DPR;canvas.height=height*DPR;canvas.style.width=width+'px';canvas.style.height=height+'px';ctx.scale(DPR,DPR);particles=[];for(let i=0;i<CONFIG.particleCount*3;i++){if(particles.length>=CONFIG.particleCount)break;const a=Math.random()*Math.PI*2;const r=Math.sqrt(Math.random())*CONFIG.clusterRadius;const x=width/2+Math.cos(a)*r*CONFIG.clusterRatioX;const y=height/2+Math.sin(a)*r*CONFIG.clusterRatioY;let ok=true;for(let p of particles){const dx=p.homeX-x;const dy=p.homeY-y;if(dx*dx+dy*dy<CONFIG.minDistance*CONFIG.minDistance){ok=false;break;}}if(ok)particles.push(new BioParticle(x,y));}GhostVoid.init();}
        function animate(){ctx.setTransform(1,0,0,1,0,0);ctx.clearRect(0,0,canvas.width,canvas.height);ctx.scale(DPR,DPR);frameCount++;GhostVoid.update(frameCount);const ex=frameCount<200;particles.forEach(p=>{p.update(frameCount,ex);p.draw();});requestAnimationFrame(animate);}
        window.addEventListener('resize',init);window.addEventListener('mousemove',e=>{mouse.x=e.clientX;mouse.y=e.clientY;});
        window.onload=()=>{init();animate();initPortfolio();};
    </script>
</body>
</html>
