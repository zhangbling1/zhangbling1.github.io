<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Antigravity Effect | Authentic Replica</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #f8f9fa; } /* æµ…ç°èƒŒæ™¯ï¼ŒåƒåŸç‰ˆ */
        canvas { display: block; }
        
        /* ç®€å•çš„ UI æ¨¡æ‹Ÿ */
        .ui-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none; /* è®©é¼ æ ‡ç©¿é€ */
            font-family: 'Google Sans', sans-serif;
            color: #202124;
        }
        h1 { font-size: 4rem; margin: 0; letter-spacing: -1px; }
        p { font-size: 1.2rem; color: #5f6368; }
    </style>
</head>
<body>

    <div class="ui-layer">
        <h1>Antigravity</h1>
        <p>Move your mouse to disturb the particles</p>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        /**
         * ğŸŒŠ Google Antigravity æ ¸å¿ƒå¤åˆ»ç‰ˆ
         * åŸºäº main-F3FYKJAU.js ä¸­çš„ Shader é€»è¾‘ç¿»è¯‘
         */

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let particles = [];
        // åŸç‰ˆ Google è“
        const COLOR_BASE = { r: 66, g: 133, b: 244 }; 
        
        // ğŸ­ é¼ æ ‡çŠ¶æ€
        const mouse = { x: -9999, y: -9999, active: false };

        // âš™ï¸ å‚æ•°é…ç½® (æ¨¡æ‹Ÿ Shader ä¸­çš„ uniform)
        const CONFIG = {
            gridSize: 15,      // ç²’å­é—´è· (è¶Šå°ç²’å­è¶Šå¤š)
            noiseScale: 0.003, // å™ªå£°ç¼©æ”¾ (æ§åˆ¶"æ°´æµ"çš„å¤§å°)
            timeSpeed: 0.005,  // æ¸¸åŠ¨é€Ÿåº¦
            ringRadius: 150,   // é¼ æ ‡å½±å“åŠå¾„ (å¯¹åº” uRingRadius)
            dispScale: 100,    // æ‰­æ›²å¼ºåº¦ (å¯¹åº” uRingDisplacement)
            baseSize: 1.5      // ç²’å­åŸºç¡€å¤§å°
        };

        // =========================================================
        // ğŸ§® Simplex Noise (ç®€åŒ–ç‰ˆï¼Œç”¨äºæ¨¡æ‹ŸåŸç‰ˆ snoise)
        // =========================================================
        const SimplexNoise = (function() {
            // ç»å…¸çš„ Perlin/Simplex å™ªå£°ç½®æ¢è¡¨
            const p = new Uint8Array([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]);
            const perm = new Uint8Array(512);
            for(let i=0; i<512; i++) perm[i] = p[i & 255];

            function dot(g, x, y) { return g[0]*x + g[1]*y; }
            const grad3 = [[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];

            return {
                noise2D: function(xin, yin) {
                    let n0, n1, n2; 
                    const F2 = 0.5*(Math.sqrt(3.0)-1.0);
                    const s = (xin+yin)*F2; 
                    const i = Math.floor(xin+s);
                    const j = Math.floor(yin+s);
                    const G2 = (3.0-Math.sqrt(3.0))/6.0;
                    const t = (i+j)*G2;
                    const X0 = i-t; 
                    const Y0 = j-t;
                    const x0 = xin-X0; 
                    const y0 = yin-Y0;
                    let i1, j1;
                    if(x0>y0) {i1=1; j1=0;} else {i1=0; j1=1;}
                    const x1 = x0 - i1 + G2; 
                    const y1 = y0 - j1 + G2;
                    const x2 = x0 - 1.0 + 2.0 * G2; 
                    const y2 = y0 - 1.0 + 2.0 * G2;
                    const ii = i & 255; 
                    const jj = j & 255;
                    const gi0 = perm[ii+perm[jj]] % 12;
                    const gi1 = perm[ii+i1+perm[jj+j1]] % 12;
                    const gi2 = perm[ii+1+perm[jj+1]] % 12;
                    let t0 = 0.5 - x0*x0 - y0*y0;
                    if(t0<0) n0 = 0.0;
                    else { t0 *= t0; n0 = t0 * t0 * dot(grad3[gi0], x0, y0); }
                    let t1 = 0.5 - x1*x1 - y1*y1;
                    if(t1<0) n1 = 0.0;
                    else { t1 *= t1; n1 = t1 * t1 * dot(grad3[gi1], x1, y1); }
                    let t2 = 0.5 - x2*x2 - y2*y2;
                    if(t2<0) n2 = 0.0;
                    else { t2 *= t2; n2 = t2 * t2 * dot(grad3[gi2], x2, y2); }
                    return 70.0 * (n0 + n1 + n2);
                }
            };
        })();

        // =========================================================
        // ğŸ§ª ç²’å­ç³»ç»Ÿ (å¤åˆ» Shader é€»è¾‘)
        // =========================================================
        
        class Particle {
            constructor(x, y) {
                this.baseX = x; // åŸå§‹ä½ç½® (refPos)
                this.baseY = y;
                this.x = x;     // å½“å‰ä½ç½® (curentPos)
                this.y = y;
                this.size = CONFIG.baseSize;
            }

            update(time) {
                // 1. è®¡ç®—ä¸é¼ æ ‡çš„è·ç¦»
                const dx = mouse.x - this.baseX;
                const dy = mouse.y - this.baseY;
                const dist = Math.sqrt(dx * dx + dy * dy);

                // 2. æ ¸å¿ƒï¼šShader ä¸­çš„å¹³æ»‘é˜¶æ¢¯å‡½æ•°å¤åˆ»
                // float t = smoothstep(uRingRadius - (uRingWidth * 2.), uRingRadius, dist) ...
                // è¿™é‡Œçš„é€»è¾‘æ˜¯åˆ›å»ºä¸€ä¸ªç¯å½¢çš„å½±å“åŒºåŸŸ
                const ringRadius = CONFIG.ringRadius;
                const ringWidth = 20; 
                
                // æ¨¡æ‹Ÿ GLSL smoothstep: clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0)
                const smoothstep = (min, max, value) => {
                    const x = Math.max(0, Math.min(1, (value - min) / (max - min)));
                    return x * x * (3 - 2 * x);
                };

                // è®¡ç®—å¯¹é¼ æ ‡çš„â€œååº”å¼ºåº¦â€ (t)
                let intensity = 0;
                if (mouse.active) {
                    // ä¸€ä¸ªå‘å¤–æ¨çš„åŠ› + ä¸€ä¸ªå†…éƒ¨çš„æ‹‰åŠ›ï¼Œå½¢æˆç¯å½¢æ³¢
                    const t1 = smoothstep(ringRadius - ringWidth * 2, ringRadius, dist);
                    const t2 = smoothstep(ringRadius, ringRadius + ringWidth, dist);
                    intensity = t1 - t2; // è¿™æ˜¯ä¸€ä¸ªæ³¢å³°åœ¨ ringRadius å¤„çš„ç¯
                }

                // 3. å™ªå£°ä½ç§» (Noise Displacement) - è®©ç²’å­åƒæ°´æ¯ä¸€æ ·æµ®åŠ¨
                // vec2 disp = vec2(noise1, noise2) * .03;
                const noiseX = SimplexNoise.noise2D(this.baseX * CONFIG.noiseScale, time * 0.5 + 10);
                const noiseY = SimplexNoise.noise2D(this.baseY * CONFIG.noiseScale, time * 0.5 + 20);
                
                const driftX = noiseX * 10; // åŸºç¡€æ¼‚æµ®
                const driftY = noiseY * 10;

                // 4. æœ€ç»ˆä½ç½®è®¡ç®—
                // pos -= (uRingPos - (curentPos + disp)) * pow(t2, .75) * uRingDisplacement;
                // ç®€å•çš„è¯´ï¼šå¦‚æœä¸å—é¼ æ ‡å½±å“ï¼Œå°±åœ¨åŸåœ°æ¼‚æµ®ï¼›å¦‚æœå—å½±å“ï¼Œå°±è¢«æ¨å¼€/æ‹‰æ‰¯
                
                const force = intensity * CONFIG.dispScale;
                const angle = Math.atan2(dy, dx); // è§’åº¦

                this.x = this.baseX + driftX + Math.cos(angle) * force;
                this.y = this.baseY + driftY + Math.sin(angle) * force;

                // 5. åŠ¨æ€å¤§å°
                // æ ¹æ®å¼ºåº¦æ”¹å˜å¤§å°ï¼Œäº§ç”Ÿâ€œå‘¼å¸æ„Ÿâ€
                this.size = CONFIG.baseSize + intensity * 2;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                
                // é¢œè‰²å¤„ç†ï¼šç¨å¾®å¸¦ç‚¹é€æ˜åº¦ï¼Œå åŠ åæ›´å¥½çœ‹
                const alpha = 0.6 + (this.size - CONFIG.baseSize) * 0.2;
                ctx.fillStyle = `rgba(${COLOR_BASE.r}, ${COLOR_BASE.g}, ${COLOR_BASE.b}, ${alpha})`;
                ctx.fill();
            }
        }

        // =========================================================
        // ğŸ¬ åŠ¨ç”»å¾ªç¯
        // =========================================================

        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            
            particles = [];
            // ç½‘æ ¼åŒ–ç”Ÿæˆç²’å­ (å¯¹åº” uPosRefs)
            for (let y = 0; y < height; y += CONFIG.gridSize) {
                for (let x = 0; x < width; x += CONFIG.gridSize) {
                    particles.push(new Particle(x, y));
                }
            }
        }

        let time = 0;
        function animate() {
            ctx.clearRect(0, 0, width, height);
            
            time += CONFIG.timeSpeed;

            // æ‰¹é‡æ›´æ–°å’Œç»˜åˆ¶
            for (let i = 0; i < particles.length; i++) {
                const p = particles[i];
                p.update(time);
                p.draw();
            }

            requestAnimationFrame(animate);
        }

        // ğŸ–±ï¸ äº‹ä»¶ç›‘å¬
        window.addEventListener('resize', init);
        window.addEventListener('mousemove', e => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
            mouse.active = true;
        });
        
        // é¼ æ ‡ç¦»å¼€æ—¶é‡ç½®
        window.addEventListener('mouseleave', () => {
            mouse.active = false;
            // å¯ä»¥åœ¨è¿™é‡ŒåŠ ä¸€ä¸ªç¼“åŠ¨è®© mouse.x/y æ…¢æ…¢å½’é›¶
        });

        // å¯åŠ¨
        init();
        animate();

    </script>
</body>
</html>
